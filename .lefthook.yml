pre-commit:
  parallel: true
  commands:
    prettier:
      run: pnpm prettier

    lint:
      run: |
        CHANGED=$(git diff --cached --name-only \
          | grep -E '^(apps|packages|tooling)/' \
          | cut -d/ -f1,2 \
          | sort -u \
          | paste -sd "," -)

        if [ -n "$CHANGED" ]; then
          turbo run lint --filter="$CHANGED"
        fi

    typecheck:
      run: |
        CHANGED=$(git diff --cached --name-only \
          | grep -E '^(apps|packages|tooling)/' \
          | cut -d/ -f1,2 \
          | sort -u \
          | paste -sd "," -)

        if [ -n "$CHANGED" ]; then
          turbo run typecheck --filter="$CHANGED"
        fi

    format:
      run: pnpm format
      stage_fixed: true

commit-msg:
  commands:
    commitlint:
      run: pnpm commitlint --edit {1}
